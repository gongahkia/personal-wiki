<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="description" content="Wiki Note: Docker - Gabriel Ong">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../style.css">
  <link rel="preload" href="https://res.hajimehoshi.com/fonts/SuisseIntl-Regular-WebXL.woff2" as="font" crossorigin="anonymous">
  <link rel="preload" href="https://res.hajimehoshi.com/fonts/SuisseIntlMono-Regular-WebXL.woff2" as="font" crossorigin="anonymous">
  <style>
    .thin-space:after{content:"\2006"}
    pre {
      overflow-x: auto;
      max-width: 100%;
    }
  </style>
  <script src="../script.js" defer></script>
  <title>GABRIEL ONG</title>
  <link rel="shortcut icon" href="../asset/blob.ico" type="image/x-icon">
</head>
<body>
  <div id="click-container"></div>
  <input type="button" id="dark-mode">
  <label for="dark-mode">
    <img id="infinityButton" src="../asset/roller.png" height="24" width="24"/>
  </label>

  <main>
    <article class="overallArticleTags">

      <section class="note-header">
        <h2>Docker</h2>

        <dl>
          <dt>File size</dt>
          <dd>16.1KB</dd>

          <dt>Lines of code</dt>
          <dd>146</dd>
        </dl>
      </section>

      <section class="note-content">
        <h1><code>Docker</code></h1>
<p>The lightweight VM of the future.</p>
<h2>Quickstart</h2>
<p>Docker allows for packaging and replication of a program's required environment on any machine, enabling rapid build, test and ship times.</p>
<ul>
<li><strong>docker image</strong>: package that includes code, system tools, libraries, runtime</li>
<li><strong>docker container</strong>: executable instance of a docker image, encapsulating the runtime environment, application code and dependencies</li>
</ul>
<h2>Docker CLI</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># ---------- DOCKER CLI -----------</span>

<span class="c1"># GENERAL</span>
<span class="w">    </span><span class="c1"># docker help =&gt; shows a helplist of all useful docker commands</span>

<span class="c1"># IMAGES</span>
<span class="w">    </span><span class="c1"># docker build {PATH TO DOCKERFILE} =&gt; builds a Docker image from the specified Dockerfile, where the path can be a local file extension or a URL, images are rebuilt whenever a change is made in the Dockerfile</span>
<span class="w">    </span><span class="c1"># docker pull {IMAGE NAME} =&gt; similar to git pull, downloads the specified image from Docker Hub</span>
<span class="w">    </span><span class="c1"># docker create {IMAGE NAME} =&gt; creates a new container with the specified image but does not run the container automatically like docker run, docker start must be used to then run this container</span>
<span class="w">    </span><span class="c1"># docker images =&gt; displays all docker images and their metadata</span>
<span class="w">    </span><span class="c1"># docker rmi =&gt; removes one or more docker images if they do not have a container instance currently running</span>

<span class="c1"># CONTAINERS</span>
<span class="w">    </span><span class="c1"># docker run {CONTAINER NAME} =&gt; runs the specified docker container and can be augmented with flags, docker will pull the required image from Docker Hub and build the container if the container is not found, then run it</span>
<span class="w">        </span><span class="c1"># -d =&gt; detach flag runs a container in the background and returns to the main terminal</span>
<span class="w">        </span><span class="c1"># -p {INNER PORT NUMBER:OUTER PORT NUMBER} =&gt; publish flag exposes the specified inner port to the specified port outside the container since the app&#39;s runtime is isolated within a given docker container</span>
<span class="w">        </span><span class="c1"># -i =&gt; input flag runs the docker container in an interactive mode, which accepts inputs and responds dynamically to said inputs while running the app, by default docker is in non-interactive mode and does not accept user input</span>
<span class="w">        </span><span class="c1"># -t =&gt; terminal flag often used in conjunction with the -i input flag (-it), creates a pseudo-terminal that the shell can latch onto</span>
<span class="w">    </span><span class="c1"># docker ps =&gt; only shows running containers </span>
<span class="w">        </span><span class="c1"># -a =&gt; all flag specifies to show all containers</span>
<span class="w">    </span><span class="c1"># docker start {CONTAINER NAME} =&gt; starts the specified container</span>
<span class="w">    </span><span class="c1"># docker stop {CONTAINER NAME} =&gt; stops the specified container</span>
<span class="w">    </span><span class="c1"># docker rm {CONTAINER ID} =&gt; removes a docker container based on the specified container ID</span>
<span class="w">    </span><span class="c1"># docker exec {CONTAINER ID} {COMMAND} =&gt; runs a command in the specified container based on container ID</span>
<span class="w">    </span><span class="c1"># docker logs {CONTAINER ID} =&gt; displays console information logged by the specified container based on container ID</span>

$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>parklane-cai-fan<span class="w"> </span><span class="c1"># assuming the container is not found on my machine, docker pulls the parklane-cai-fan image from Docker Hub, builds the container, and runs it</span>
$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>parklane-cai-fan<span class="w"> </span><span class="c1"># detaches the container from the terminal</span>
$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>10f10<span class="w"> </span>-p<span class="w"> </span><span class="m">3000</span>:8000<span class="w"> </span><span class="c1"># exposes port 8000 within the parklane-cai-fan container (of container ID 10f10) to the exterior port 3000 outside the container</span>
$<span class="w"> </span>docker<span class="w"> </span>stop<span class="w"> </span>parklane-cai-fan<span class="w"> </span><span class="c1"># stops the docker container parklane-cai-fan from running</span>
$<span class="w"> </span>docker<span class="w"> </span>start<span class="w"> </span>parklane-cai-fan<span class="w"> </span><span class="c1"># starts the docker container parklane-cai-fan and runs it</span>

$<span class="w"> </span>docker<span class="w"> </span>ps<span class="w"> </span>-a<span class="w"> </span><span class="c1"># displays all containers, including those not currently running</span>

$<span class="w"> </span>docker<span class="w"> </span>create<span class="w"> </span>isle-eating-house<span class="w"> </span><span class="c1"># creates a new container from the image isle-eating-house, but does not run it</span>
$<span class="w"> </span>docker<span class="w"> </span>rm<span class="w"> </span>82f82<span class="w"> </span><span class="c1"># removes the container isle-eating-house based on its container ID 82f82</span>

$<span class="w"> </span>docker<span class="w"> </span>images<span class="w"> </span><span class="c1"># displays all existing docker images on your machine</span>
$<span class="w"> </span>docker<span class="w"> </span>rmi<span class="w"> </span><span class="c1"># removes all docker images that do not currently have a docker container running</span>
$<span class="w"> </span>docker<span class="w"> </span>pull<span class="w"> </span>a1-dumplings<span class="w"> </span><span class="c1"># pulls the a1-dumplings image from Docker Hub and downloads it to our machine</span>

$<span class="w"> </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>77b77<span class="w"> </span>ls<span class="w"> </span><span class="c1"># runs the command &#39;ls&#39; in the a1-dumplings container (of container ID 77b77) </span>
$<span class="w"> </span>docker<span class="w"> </span>logs<span class="w"> </span>77b77<span class="w"> </span><span class="c1"># displays the console output displayed to the stdout from the executed &#39;ls&#39; command issued to the a1-dumplings container</span>

$<span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>Desktop/coding/proj/Dockerfile<span class="w"> </span><span class="c1"># builds an image from the Dockerfile at the specified local file extension</span>
</code></pre></div>

<h2>Dockerfile</h2>
<ul>
<li>file name must be <code>Dockerfile</code> with no extension (similar to a Makefile)</li>
<li>blueprint of a Docker image</li>
<li>enables further configuration of existing Docker base images</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c"># ---------- DOCKERFILE ----------</span>
<span class="w">    </span>#<span class="w"> </span>FROM<span class="w"> </span><span class="o">{</span>BASE<span class="w"> </span>IMAGE<span class="w"> </span>NAME<span class="o">}</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>specifies<span class="w"> </span>the<span class="w"> </span>base<span class="w"> </span>image<span class="w"> </span>the<span class="w"> </span>Dockerfile<span class="w"> </span>should<span class="w"> </span>be<span class="w"> </span>created<span class="w"> </span>from<span class="w"> </span>
<span class="w">    </span>#<span class="w"> </span>ENV<span class="w"> </span><span class="o">{</span>ENVIRONMENT<span class="w"> </span>VARIABLES<span class="o">}</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>specifies<span class="w"> </span>further<span class="w"> </span>environment<span class="w"> </span>variables<span class="w"> </span>as<span class="w"> </span>required
<span class="w">    </span>#<span class="w"> </span>RUN<span class="w"> </span><span class="o">{</span>LINUX<span class="w"> </span>COMMANDS<span class="o">}</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>runs<span class="w"> </span>any<span class="w"> </span>linux<span class="w"> </span>commands<span class="w"> </span>within<span class="w"> </span>the<span class="w"> </span>creation<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>image
<span class="w">    </span>#<span class="w"> </span>COPY<span class="w"> </span><span class="o">{</span>SOURCE<span class="w"> </span>LOCATION<span class="o">}</span><span class="w"> </span><span class="o">{</span>TARGET<span class="w"> </span>LOCATION<span class="o">}</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>copies<span class="w"> </span>files<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span><span class="nb">source</span><span class="w"> </span>location<span class="w"> </span><span class="o">(</span>usually<span class="w"> </span>the<span class="w"> </span>host<span class="w"> </span>machine<span class="o">)</span><span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>target<span class="w"> </span>location<span class="w"> </span><span class="o">(</span>usually<span class="w"> </span>within<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>container<span class="o">)</span>
<span class="w">    </span>#<span class="w"> </span>ENTRYPOINT<span class="w"> </span><span class="o">[{</span>SCRIPT<span class="w"> </span>NAME<span class="o">}]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>executes<span class="w"> </span>an<span class="w"> </span>entire<span class="w"> </span>specified<span class="w"> </span>script<span class="w"> </span>as<span class="w"> </span>an<span class="w"> </span>entrypoint<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>setup<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>image
<span class="w">    </span>#<span class="w"> </span>CMD<span class="w"> </span><span class="o">[{</span>LIST<span class="w"> </span>OF<span class="w"> </span>ARGUMENTS<span class="o">}]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>always<span class="w"> </span>a<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>every<span class="w"> </span>Dockerfile,<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>default<span class="w"> </span>commands<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>whenever<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>image<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>created<span class="w"> </span>and<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>container<span class="w"> </span>is<span class="w"> </span>running

<span class="k">FROM</span><span class="w"> </span><span class="s">parklane-cai-fan</span><span class="w"> </span><span class="c"># defines the base Docker image</span>

<span class="k">ENV</span><span class="w"> </span><span class="nv">USERNAME</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="se">\</span>
<span class="w">    </span><span class="nv">PWD</span><span class="o">=</span><span class="s1">&#39;watermelon&#39;</span><span class="w"> </span>#<span class="w"> </span>defines<span class="w"> </span>some<span class="w"> </span>environment<span class="w"> </span>variables

<span class="k">RUN</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>upgrade<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>autoremove<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>~/.customConfig<span class="w"> </span>#<span class="w"> </span>runs<span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>linux<span class="w"> </span>commands

<span class="k">COPY</span><span class="w"> </span>~/.vimrc<span class="w"> </span>~/.customConfig<span class="w"> </span>#<span class="w"> </span>copies<span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>file<span class="w"> </span>.vimrc<span class="w"> </span>from<span class="w"> </span><span class="nb">local</span><span class="w"> </span>machine<span class="w"> </span>to<span class="w"> </span>within<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>container

<span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;watermelon.sh&quot;</span><span class="p">]</span><span class="w"> </span>#<span class="w"> </span>executes<span class="w"> </span>the<span class="w"> </span>watermelon.sh<span class="w"> </span>script<span class="w"> </span>as<span class="w"> </span>an<span class="w"> </span>entrypoint

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;uncleTopia.py&quot;</span><span class="p">]</span><span class="w"> </span>#<span class="w"> </span>defines<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>commands<span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>when<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>container<span class="w"> </span>starts<span class="w"> </span>up
</code></pre></div>

<h2>More on</h2>
<ul>
<li><a href="https://learnxinyminutes.com/docs/docker/">pushing docker images to Docker Hub</a></li>
<li><a href="https://docs.docker.com/get-docker/">install docker</a></li>
<li><a href="https://hub.docker.com/">docker hub</a></li>
<li><a href="https://docs.docker.com/engine/reference/builder/">dockerfile documentation</a></li>
</ul>
      </section>

    </article>

    <footer>
      <p>© 2023-<span id="current-year"></span> Gabriel Ong. All rights reserved.</p>
    </footer>
  </main>

  <div class="wrapper"></div>
</body>
</html>
